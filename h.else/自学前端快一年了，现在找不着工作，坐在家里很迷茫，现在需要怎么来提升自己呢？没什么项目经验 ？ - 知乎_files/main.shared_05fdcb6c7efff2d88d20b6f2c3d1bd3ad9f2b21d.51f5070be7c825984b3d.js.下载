(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{1087:function(e,t,n){"use strict";var a=n(0),r=n(316),c=n.n(r),i=n(105);t.a=function(e,t,n){var r=Object(i.a)(t);Object(a.useEffect)((function(){return c.a.bind(e,r,n),function(){c.a.unbind(e)}}),[JSON.stringify(e),r,n])}},1157:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(t){return setTimeout(t,e)}))};function r(e){var t=[];return e.reduce((function(e,n){return e.then((function(){return n().then((function(e){t.push(e)}))}))}),Promise.resolve()).then((function(){return t}))}},1208:function(e,t,n){"use strict";var a=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;t.a=function(e){return a.test(e)}},1278:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var a=n(37),r=n(15),c=n(16),i=n(18),o=n(19),s=n(9),l=n(1),u=n(3),d=n.n(u),g=n(0),p=n.n(g),h=n(33),f=n(12),A=Object.assign;function b(e){return p.a.createElement(f.a,A(A({width:"24",height:"24",viewBox:"0 0 24 24","data-new-api":"EyeAlt24","data-old-api":"EyeAlt24"},e),{className:"ZDI ZDI--EyeAlt24"+(e.className?" ".concat(e.className):"")}),p.a.createElement("path",{d:"M12.001 20.717c5.343 0 8.282-3.087 9.674-5.294a5.88 5.88 0 00.392-5.525C20.919 7.293 18.107 3.283 12 3.283c-6.103 0-8.916 4.005-10.066 6.61l1.372.606-1.372-.606a5.882 5.882 0 00.392 5.534c1.395 2.207 4.334 5.29 9.674 5.29zm-8.406-6.091a4.382 4.382 0 01-.288-4.127c1.025-2.322 3.425-5.716 8.694-5.716 5.272 0 7.67 3.398 8.693 5.72a4.38 4.38 0 01-.288 4.12c-1.224 1.94-3.75 4.594-8.405 4.594-4.653 0-7.18-2.65-8.406-4.591zM9.75 12a2.25 2.25 0 114.5 0 2.25 2.25 0 01-4.5 0zM12 8.25a3.75 3.75 0 100 7.5 3.75 3.75 0 000-7.5z",fillRule:"evenodd",clipRule:"evenodd"}))}var m=n(1609),C=n(71),E=n.n(C),v=n(314),I=["switchDisabled","placeholderPrefix"];function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(s.a)(e);if(t){var r=Object(s.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(o.a)(this,n)}}var S=function(e){Object(i.a)(n,e);var t=B(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).handleSwitchPasswordInputType=function(){a.setState((function(e){return{inputType:"password"===e.inputType?"text":"password"}}))},a.handleChange=function(e){a.state.hasValue!==Boolean(e)&&a.setState({hasValue:Boolean(e)}),a.props.onChange(e)},a.state={hasValue:Boolean(e.defaultValue),inputType:e.defaultType},a}return Object(c.a)(n,[{key:"render",value:function(){var e=E()(this.props,["onChange","defaultType"]),t=e.switchDisabled,n=e.placeholderPrefix,r=Object(a.default)(e,I),c=this.state,i=c.inputType,o=c.hasValue;return Object(l.c)("div",{className:"SignFlow-password",children:[Object(l.b)(v.a,Object.assign({name:"password",inputClassName:"password"===i&&o?"SignFlow-passwordInput":"",type:i,placeholder:"".concat(n||"","密码"),onChange:this.handleChange,errorMessageClassName:"SignFlow-passwordErrorMask",validations:[{type:"required",message:"请输入密码",className:"SignFlow-requiredPasswordErrorMask"}]},r)),!t&&Object(l.b)(h.c,{className:"SignFlow-switchPassword",tabIndex:-1,preset:"plain",onClick:this.handleSwitchPasswordInputType,icon:"password"===i?b:m.a})]})}}]),n}(g.Component);S.propTypes={onChange:d.a.func.isRequired,switchDisabled:d.a.bool,defaultType:d.a.string},S.defaultProps={defaultType:"password"}},1282:function(e,t,n){"use strict";var a=n(37),r=n(15),c=n(16),i=n(18),o=n(19),s=n(9),l=n(1),u=n(3),d=n.n(u),g=n(0),p=n(314),h=["onChange","validations"];function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(s.a)(e);if(t){var r=Object(s.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(o.a)(this,n)}}var A=function(e){Object(i.a)(n,e);var t=f(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props,t=e.onChange,n=e.validations,r=Object(a.default)(e,h);return Object(l.b)(p.a,Object.assign({className:"SignFlow-username",onChange:t,validations:n||[{type:"required",message:"请输入用户名"}]},r))}}]),n}(g.Component);A.propTypes={onChange:d.a.func.isRequired};t.a=A},1295:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var a=n(0),r=n.n(a),c=n(12),i=Object.assign;function o(e){return r.a.createElement(c.a,i(i({width:"24",height:"24",viewBox:"0 0 24 24","data-new-api":"ArrowLeftSmall24","data-old-api":"ArrowLeftSmall24"},e),{className:"ZDI ZDI--ArrowLeftSmall24"+(e.className?" ".concat(e.className):"")}),r.a.createElement("path",{d:"M10.752 12l4.025-3.78a.684.684 0 000-1.01.796.796 0 00-1.075 0l-4.42 4.15a.866.866 0 000 1.28l4.42 4.15a.796.796 0 001.075 0 .684.684 0 000-1.01L10.752 12z",fillRule:"evenodd",clipRule:"evenodd"}))}function s(e){return r.a.createElement(c.a,i(i({width:"24",height:"24",viewBox:"0 0 24 24","data-new-api":"ArrowLeftSmall24","data-old-api":"ArrowLeft"},e),{className:"Zi Zi--ArrowLeft"+(e.className?" ".concat(e.className):"")}),r.a.createElement("path",{d:"M10.752 12l4.025-3.78a.684.684 0 000-1.01.796.796 0 00-1.075 0l-4.42 4.15a.866.866 0 000 1.28l4.42 4.15a.796.796 0 001.075 0 .684.684 0 000-1.01L10.752 12z",fillRule:"evenodd",clipRule:"evenodd"}))}},1296:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var a=n(37),r=n(13),c=n.n(r),i=["className","label","tabIndex"];function o(e){return"Enter"===e.key||" "===e.key||"Enter"===e.code||"Space"===e.code||13===e.keyCode||32===e.keyCode}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.className,r=t.label,s=void 0===r?"":r,l=t.tabIndex,u=void 0===l?0:l,d=Object(a.default)(t,i);return Object.assign(Object.assign({role:"button",tabIndex:u,onClick:e,onKeyDown:function(t){o(t)&&e(t)},className:c()("a11y-button",n)},s&&{"aria-label":s}),d)}},1297:function(e,t,n){},1427:function(e,t,n){"use strict";var a=n(2),r=n(15),c=n(16),i=n(18),o=n(19),s=n(9),l=n(1),u=n(0),d=n(20),g=n(21),p=n(33),h=n(173),f=n(299),A=n(509),b=n(300),m=n(516),C=n(1278),E=n(1282);n(1297);function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(s.a)(e);if(t){var r=Object(s.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(o.a)(this,n)}}var I={phoneNoError:null,fullnameError:null,passwordError:null,digitsError:null},B=function(e){Object(i.a)(n,e);var t=v(n);function n(){var e;Object(r.a)(this,n);for(var c=arguments.length,i=new Array(c),o=0;o<c;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).state={email:"",password:"",fullname:"",customErrorInputMap:Object.assign({},I)},e.handleChange=function(t){return function(n){e.setState(Object(a.a)({},t,n))}},e.handleSubmit=function(){var t=e.props,n=t.validateAndRegister;(0,t.resetRegisterValidateResult)();var a=e.state;n({source:"com.zhihu.web",registerType:"email",email:a.email,password:a.password,fullname:a.fullname})},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.props.isLogin&&(location.href="https://www.zhihu.com/logout?next=/email-register")}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props.registerConfirmSucceeded,n=e.registerConfirmSucceeded;!t&&n&&(location.href="/")}},{key:"render",value:function(){var e=this.props.registerValidateErrors,t=e.email,n=(t=void 0===t?{}:t).message,a=e.fullname,r=(a=void 0===a?{}:a).message,c=e.password,i=(c=void 0===c?{}:c).message;return Object(l.b)(f.a,{children:Object(l.c)(b.b,{className:"SignContainer-content EmailRegister",onSubmit:this.handleSubmit,children:[Object(l.b)(E.a,{onChange:this.handleChange("fullname"),name:"fullname",placeholder:"用户名",manualValidateError:r}),Object(l.b)(m.a,{type:"register",placeholder:"输入邮箱",onChange:this.handleChange("email"),manualValidateError:n,supportedCountriesShown:!1}),Object(l.b)(C.a,{onChange:this.handleChange("password"),manualValidateError:i}),Object(l.b)(p.c,{className:"EmailRegister-submitButton",preset:"primary",color:"blue",type:"submit",children:"注册"})]})})}}]),n}(u.Component);t.a=Object(d.compose)(h.a,Object(g.connect)((function(e){var t=e.register;return{registerValidateErrors:t.registerValidateErrors,registerConfirmSucceeded:t.registerConfirmSucceeded}}),{validateAndRegister:A.d,resetRegisterValidateResult:A.c}))(B)},1437:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var a="SignContainerModal";function r(e){return e===a?"登录框":"登录页"}},1438:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var a=n(48),r={400:"请求参数有误",401:"用户认证失败",403:"服务已拒绝",404:"资源不存在",405:"请求方式有误",410:"资源已解散",502:"网关错误",503:"服务无响应",504:"网关超时"},c=function(e){var t;return(null==e||null===(t=e.payload)||void 0===t?void 0:t.message)||(null==e?void 0:e.status)&&r[e.status]||"操作失败"};t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(a.a)("ui/showToast").dispatch({icon:"fail",text:c(e)})}},1439:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o}));var a=n(0),r=n.n(a),c=n(12),i=Object.assign;function o(e){return r.a.createElement(c.a,i(i({width:"24",height:"24",fill:"none",viewBox:"0 0 24 24","data-new-api":"Wechat24","data-old-api":"Wechat24"},e),{className:"ZDI ZDI--Wechat24"+(e.className?" ".concat(e.className):"")}),r.a.createElement("path",{fill:"#07C160",d:"M20.314 18.59c1.333-.968 2.186-2.397 2.186-3.986 0-2.91-2.833-5.27-6.325-5.27-3.494 0-6.325 2.36-6.325 5.27 0 2.911 2.831 5.271 6.325 5.271a7.465 7.465 0 002.064-.288l.186-.029c.122 0 .232.038.336.097l1.386.8.12.04a.21.21 0 00.212-.211l-.034-.154-.285-1.063-.023-.135a.42.42 0 01.177-.343zM9.09 3.513C4.9 3.514 1.5 6.346 1.5 9.84c0 1.905 1.022 3.622 2.622 4.781a.505.505 0 01.213.412l-.026.16-.343 1.276-.04.185c0 .14.113.254.252.254l.146-.047 1.663-.96a.793.793 0 01.403-.116l.222.032c.806.231 1.64.348 2.478.348l.417-.01a4.888 4.888 0 01-.255-1.55c0-3.186 3.1-5.77 6.923-5.77l.411.011c-.57-3.02-3.71-5.332-7.494-5.332zm4.976 10.248a.843.843 0 110-1.685.843.843 0 010 1.684v.001zm4.217 0a.843.843 0 110-1.685.843.843 0 010 1.684v.001zM6.561 8.827a1.012 1.012 0 110-2.023 1.012 1.012 0 010 2.023zm5.061 0a1.012 1.012 0 110-2.023 1.012 1.012 0 010 2.023z",clipRule:"evenodd"}))}function s(e){return r.a.createElement(c.a,i(i({width:"24",height:"24",fill:"none",viewBox:"0 0 24 24","data-new-api":"Wechat24","data-old-api":"WeChatMessage"},e),{className:"Zi Zi--WeChatMessage"+(e.className?" ".concat(e.className):"")}),r.a.createElement("path",{fill:"#07C160",d:"M20.314 18.59c1.333-.968 2.186-2.397 2.186-3.986 0-2.91-2.833-5.27-6.325-5.27-3.494 0-6.325 2.36-6.325 5.27 0 2.911 2.831 5.271 6.325 5.271a7.465 7.465 0 002.064-.288l.186-.029c.122 0 .232.038.336.097l1.386.8.12.04a.21.21 0 00.212-.211l-.034-.154-.285-1.063-.023-.135a.42.42 0 01.177-.343zM9.09 3.513C4.9 3.514 1.5 6.346 1.5 9.84c0 1.905 1.022 3.622 2.622 4.781a.505.505 0 01.213.412l-.026.16-.343 1.276-.04.185c0 .14.113.254.252.254l.146-.047 1.663-.96a.793.793 0 01.403-.116l.222.032c.806.231 1.64.348 2.478.348l.417-.01a4.888 4.888 0 01-.255-1.55c0-3.186 3.1-5.77 6.923-5.77l.411.011c-.57-3.02-3.71-5.332-7.494-5.332zm4.976 10.248a.843.843 0 110-1.685.843.843 0 010 1.684v.001zm4.217 0a.843.843 0 110-1.685.843.843 0 010 1.684v.001zM6.561 8.827a1.012 1.012 0 110-2.023 1.012 1.012 0 010 2.023zm5.061 0a1.012 1.012 0 110-2.023 1.012 1.012 0 010 2.023z",clipRule:"evenodd"}))}function l(e){return r.a.createElement(c.a,i(i({width:"24",height:"24",fill:"none",viewBox:"0 0 24 24","data-new-api":"Wechat24","data-old-api":"WeChat"},e),{className:"Zi Zi--WeChat"+(e.className?" ".concat(e.className):"")}),r.a.createElement("path",{fill:"#07C160",d:"M20.314 18.59c1.333-.968 2.186-2.397 2.186-3.986 0-2.91-2.833-5.27-6.325-5.27-3.494 0-6.325 2.36-6.325 5.27 0 2.911 2.831 5.271 6.325 5.271a7.465 7.465 0 002.064-.288l.186-.029c.122 0 .232.038.336.097l1.386.8.12.04a.21.21 0 00.212-.211l-.034-.154-.285-1.063-.023-.135a.42.42 0 01.177-.343zM9.09 3.513C4.9 3.514 1.5 6.346 1.5 9.84c0 1.905 1.022 3.622 2.622 4.781a.505.505 0 01.213.412l-.026.16-.343 1.276-.04.185c0 .14.113.254.252.254l.146-.047 1.663-.96a.793.793 0 01.403-.116l.222.032c.806.231 1.64.348 2.478.348l.417-.01a4.888 4.888 0 01-.255-1.55c0-3.186 3.1-5.77 6.923-5.77l.411.011c-.57-3.02-3.71-5.332-7.494-5.332zm4.976 10.248a.843.843 0 110-1.685.843.843 0 010 1.684v.001zm4.217 0a.843.843 0 110-1.685.843.843 0 010 1.684v.001zM6.561 8.827a1.012 1.012 0 110-2.023 1.012 1.012 0 010 2.023zm5.061 0a1.012 1.012 0 110-2.023 1.012 1.012 0 010 2.023z",clipRule:"evenodd"}))}},1440:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var a=n(0),r=n.n(a),c=n(12),i=Object.assign;function o(e){return r.a.createElement(c.a,i(i({width:"24",height:"24",fill:"none",viewBox:"0 0 24 24","data-new-api":"Weibo24","data-old-api":"Weibo24"},e),{className:"ZDI ZDI--Weibo24"+(e.className?" ".concat(e.className):"")}),r.a.createElement("path",{fill:"#FB6622",d:"M15.518 3.06c8.834-.854 7.395 7.732 7.394 7.731-.625 1.44-1.673.31-1.673.31.596-7.52-5.692-6.33-5.692-6.33-.898-1.067-.03-1.71-.03-1.71zm4.13 6.985c-.66 1.01-1.376.126-1.375.126.205-3.179-2.396-2.598-2.396-2.598-.72-.765-.091-1.346-.091-1.346 4.882-.55 3.863 3.818 3.863 3.818zM5.318 7.52s4.615-3.86 6.443-1.328c0 0 .662 1.08-.111 2.797.003-.003 3.723-1.96 5.408.16 0 0 .848 1.094-.191 2.648 0 0 2.918-.099 2.918 2.715 0 2.811-4.104 6.44-9.315 6.44-5.214 0-8.026-2.092-8.596-3.102 0 0-3.475-4.495 3.444-10.33zm10.448 7.792s.232-4.41-5.71-4.207c-6.652.231-6.58 4.654-6.58 4.654.022.39.098 3.713 5.843 3.713 5.98 0 6.447-4.16 6.447-4.16zm-9.882.86s-.06-3.632 3.804-3.56c3.412.06 3.206 3.164 3.206 3.164s-.026 2.98-3.684 2.98c-3.288 0-3.326-2.584-3.326-2.584zm2.528 1.037c.672 0 1.212-.447 1.212-.998 0-.55-.543-.998-1.212-.998-.672 0-1.215.447-1.215.998 0 .551.546.998 1.215.998z",clipRule:"evenodd"}))}function s(e){return r.a.createElement(c.a,i(i({width:"24",height:"24",fill:"none",viewBox:"0 0 24 24","data-new-api":"Weibo24","data-old-api":"Weibo"},e),{className:"Zi Zi--Weibo"+(e.className?" ".concat(e.className):"")}),r.a.createElement("path",{fill:"#FB6622",d:"M15.518 3.06c8.834-.854 7.395 7.732 7.394 7.731-.625 1.44-1.673.31-1.673.31.596-7.52-5.692-6.33-5.692-6.33-.898-1.067-.03-1.71-.03-1.71zm4.13 6.985c-.66 1.01-1.376.126-1.375.126.205-3.179-2.396-2.598-2.396-2.598-.72-.765-.091-1.346-.091-1.346 4.882-.55 3.863 3.818 3.863 3.818zM5.318 7.52s4.615-3.86 6.443-1.328c0 0 .662 1.08-.111 2.797.003-.003 3.723-1.96 5.408.16 0 0 .848 1.094-.191 2.648 0 0 2.918-.099 2.918 2.715 0 2.811-4.104 6.44-9.315 6.44-5.214 0-8.026-2.092-8.596-3.102 0 0-3.475-4.495 3.444-10.33zm10.448 7.792s.232-4.41-5.71-4.207c-6.652.231-6.58 4.654-6.58 4.654.022.39.098 3.713 5.843 3.713 5.98 0 6.447-4.16 6.447-4.16zm-9.882.86s-.06-3.632 3.804-3.56c3.412.06 3.206 3.164 3.206 3.164s-.026 2.98-3.684 2.98c-3.288 0-3.326-2.584-3.326-2.584zm2.528 1.037c.672 0 1.212-.447 1.212-.998 0-.55-.543-.998-1.212-.998-.672 0-1.215.447-1.215.998 0 .551.546.998 1.215.998z",clipRule:"evenodd"}))}},1609:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(0),r=n.n(a),c=n(12),i=Object.assign;function o(e){return r.a.createElement(c.a,i(i({width:"24",height:"24",viewBox:"0 0 24 24","data-new-api":"EyeSlash24","data-old-api":"EyeSlash24"},e),{className:"ZDI ZDI--EyeSlash24"+(e.className?" ".concat(e.className):"")}),r.a.createElement("path",{d:"M7.517 4.474c1.206-.453 2.608-.724 4.234-.724 6.036 0 8.834 3.715 9.985 6.161a5.255 5.255 0 01-.393 5.219 11.207 11.207 0 01-3.027 3.036.75.75 0 11-.835-1.245c.058-.04.115-.078.171-.118a9.704 9.704 0 002.447-2.511 3.755 3.755 0 00.28-3.742c-1.003-2.131-3.374-5.3-8.628-5.3-1.456 0-2.679.242-3.706.628a.75.75 0 11-.528-1.404zM5.498 6.382a.75.75 0 01-.07 1.059c-1.126.987-1.854 2.148-2.306 3.105a3.756 3.756 0 00.281 3.749c1.206 1.787 3.71 4.26 8.348 4.26 1.237 0 2.315-.175 3.253-.462a.75.75 0 11.438 1.435c-1.084.33-2.31.527-3.69.527-5.28 0-8.198-2.855-9.592-4.921a5.256 5.256 0 01-.394-5.228c.513-1.09 1.353-2.435 2.674-3.593a.75.75 0 011.058.07z",fillRule:"evenodd",clipRule:"evenodd"}),r.a.createElement("path",{d:"M20.048 20.012a.75.75 0 01-1.06.036l-15.5-14.5a.75.75 0 011.025-1.096l15.5 14.5a.75.75 0 01.035 1.06z",fillRule:"evenodd",clipRule:"evenodd"}),r.a.createElement("path",{d:"M9.559 11.535c-.203 1.067.554 2.164 1.808 2.374a2.36 2.36 0 001.707-.36.75.75 0 011.043.191.75.75 0 01-.215 1.04 3.893 3.893 0 01-2.816.602c-1.984-.331-3.381-2.13-3.007-4.094.06-.311.16-.607.297-.881a.768.768 0 011.01-.358.733.733 0 01.338.995 1.908 1.908 0 00-.165.491zm1.219-2.362a.769.769 0 01.716-.797c.302-.02.61-.007.92.045 1.784.299 3.086 1.775 3.066 3.501a.77.77 0 01-.762.754.73.73 0 01-.744-.74c.011-.948-.72-1.854-1.842-2.041a2.427 2.427 0 00-.566-.028.732.732 0 01-.788-.694z",fillRule:"evenodd",clipRule:"evenodd"}))}},1610:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var a=n(0),r=n.n(a),c=n(12),i=Object.assign;function o(e){return r.a.createElement(c.a,i(i({width:"24",height:"24",viewBox:"0 0 24 24","data-new-api":"Qq24","data-old-api":"Qq24"},e),{className:"ZDI ZDI--Qq24"+(e.className?" ".concat(e.className):"")}),r.a.createElement("path",{d:"M12.003 2c-2.265 0-6.29 1.364-6.29 7.325v1.195S3.55 14.96 3.55 17.474c0 .665.17 1.025.281 1.025.114 0 .902-.483 1.748-2.072 0 0-.18 2.197 1.904 3.967 0 0-1.77.495-1.77 1.182 0 .686 4.078.43 6.29 0 2.239.425 6.288.687 6.288 0 0-.688-1.77-1.182-1.77-1.182 2.086-1.77 1.906-3.967 1.906-3.967.845 1.588 1.634 2.072 1.746 2.072.111 0 .283-.36.283-1.025 0-2.514-2.165-6.954-2.165-6.954V9.325C18.29 3.364 14.268 2 12.003 2z",fillRule:"evenodd",clipRule:"evenodd"}))}function s(e){return r.a.createElement(c.a,i(i({width:"24",height:"24",viewBox:"0 0 24 24","data-new-api":"Qq24","data-old-api":"QQ"},e),{className:"Zi Zi--QQ"+(e.className?" ".concat(e.className):"")}),r.a.createElement("path",{d:"M12.003 2c-2.265 0-6.29 1.364-6.29 7.325v1.195S3.55 14.96 3.55 17.474c0 .665.17 1.025.281 1.025.114 0 .902-.483 1.748-2.072 0 0-.18 2.197 1.904 3.967 0 0-1.77.495-1.77 1.182 0 .686 4.078.43 6.29 0 2.239.425 6.288.687 6.288 0 0-.688-1.77-1.182-1.77-1.182 2.086-1.77 1.906-3.967 1.906-3.967.845 1.588 1.634 2.072 1.746 2.072.111 0 .283-.36.283-1.025 0-2.514-2.165-6.954-2.165-6.954V9.325C18.29 3.364 14.268 2 12.003 2z",fillRule:"evenodd",clipRule:"evenodd"}))}},1812:function(e,t,n){"use strict";n.d(t,"a",(function(){return Jt}));var a=n(37),r=n(1),c=n(25),i=n(15),o=n(16),s=n(18),l=n(19),u=n(9),d=n(3),g=n.n(d),p=n(0),h=n.n(p),f=n(20),A=n(21),b=n(49),m=n(59),C=n(13),E=n.n(C),v=n(46),I=n(442),B=n(12),S=Object.assign;function O(e){return h.a.createElement(B.a,S(S({width:"24",height:"24",viewBox:"0 0 24 24","data-new-api":"CheckCircle24","data-old-api":"CheckCircle24"},e),{className:"ZDI ZDI--CheckCircle24"+(e.className?" ".concat(e.className):"")}),h.a.createElement("g",{fillRule:"evenodd",clipRule:"evenodd"},h.a.createElement("path",{d:"M12 20.5a8.5 8.5 0 100-17 8.5 8.5 0 000 17zm0 1.5c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"}),h.a.createElement("path",{d:"M10.414 15.175a.75.75 0 010-1.06L15.16 9.37a.75.75 0 011.06 1.06l-4.744 4.745a.75.75 0 01-1.06 0z"}),h.a.createElement("path",{d:"M7.78 11.48a.75.75 0 011.061 0l2.634 2.634a.75.75 0 01-1.06 1.061L7.78 12.541a.75.75 0 010-1.06z"})))}var w=Object.assign;function Q(e){return h.a.createElement(B.a,w(w({width:"24",height:"24",viewBox:"0 0 24 24","data-new-api":"ExclamationCircle24","data-old-api":"ExclamationCircle24"},e),{className:"ZDI ZDI--ExclamationCircle24"+(e.className?" ".concat(e.className):"")}),h.a.createElement("path",{d:"M12 20.5a8.5 8.5 0 100-17 8.5 8.5 0 000 17zm0 1.5c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",fillRule:"evenodd",clipRule:"evenodd"}),h.a.createElement("path",{d:"M12 7a.75.75 0 01.75.75v5a.75.75 0 01-1.5 0v-5A.75.75 0 0112 7z",fillRule:"evenodd",clipRule:"evenodd"}),h.a.createElement("path",{d:"M13 16a1 1 0 11-2 0 1 1 0 012 0z"}))}var y=n(313),j=n(264),k=n(39),T=n(51),R=n(79),N=n.n(R),z=function(e){return N()((function(t){var n=Object(T.l)().trackEvent;return Object(r.b)(e,Object.assign({trackEvent:n},t))}),e)},x=n(52),D=Object.assign;var M=function(e){return h.a.createElement(x.a,D({width:"52",height:"52",fill:"none"},e),h.a.createElement("mask",{id:"id-320414155-a",width:"52",height:"52",x:"0",y:"0",maskUnits:"userSpaceOnUse"},h.a.createElement("path",{fill:"#fff",d:"M0 0l52 52V0H0z"})),h.a.createElement("g",{mask:"url(#id-320414155-a)"},h.a.createElement("path",{fill:"#06F",d:"M0 0l52 52V0H0z"}),h.a.createElement("path",{fill:"#fff",d:"M22.125 4h13.75A4.125 4.125 0 0140 8.125v27.75A4.125 4.125 0 0135.875 40h-13.75A4.125 4.125 0 0118 35.875V8.125A4.125 4.125 0 0122.125 4zm6.938 34.222c1.139 0 2.062-.945 2.062-2.11 0-1.167-.923-2.112-2.063-2.112-1.139 0-2.062.945-2.062 2.111 0 1.166.923 2.111 2.063 2.111zM21 8.333v24h16v-24H21z",fillRule:"evenodd",clipRule:"evenodd"}),h.a.createElement("path",{fill:"#fff",d:"M46.996 15.482L39 19.064l-7.996-3.582A1.6 1.6 0 0132.6 14h12.8a1.6 1.6 0 011.596 1.482zM47 16.646V24.4a1.6 1.6 0 01-1.6 1.6H32.6a1.6 1.6 0 01-1.6-1.6v-7.754l8 3.584 8-3.584z",fillRule:"evenodd",clipRule:"evenodd"}),h.a.createElement("path",{fill:"#06F",d:"M31 15.483v1.17l8 3.577 8-3.577v-1.17l-8 3.581-8-3.581z"})))};function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(u.a)(e);if(t){var r=Object(u.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(l.a)(this,n)}}var U=function(e){Object(s.a)(n,e);var t=P(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).cancelCheckQrcodeScanStatus=function(){a.timer&&window.clearInterval(a.timer)},a.checkQrcodeScanStatus=function(e){var t=a.props,n=t.checkQrcodeScanStatus,r=t.trackEvent,c=t.isSignPage;a.timer=setInterval((function(){n({token:e}).then((function(e){var t;null!==(t=e.payload)&&void 0!==t&&t.accessToken&&!c&&(null==r||r({block:"qrcode_loginSuccess"}))}))}),2e3)},a.handleChangeStatus=function(e,t){a.setState({status:e}),"init"!==e||t||a.getToken(),v.b.increment("logIn.qrcode.".concat(e,".count"),.001)},a.handleChangeLoginType=function(){var e=a.props.onChangeType;a.cancelCheckQrcodeScanStatus(),e()},a.state={type:"password",status:"init",errorMessage:"",guideTypeSymbol:"d"},a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.isInSignPage,t=this.state.guideTypeSymbol;e&&c.a.trackCardShow(null,{id:9214,name:t}),this.getToken()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.qrcodeLoginToken,a=t.qrcodeLoginScanStatus,r=e.qrcodeLoginToken,c=e.qrcodeLoginScanStatus,i=e.qrcodeLoginError,o=e.qrcodeLoginReturnNewToken;""!==r&&n!==r?(this.cancelCheckQrcodeScanStatus(),"init"!==this.state.status&&this.handleChangeStatus("init",!0),this.checkQrcodeScanStatus(r)):a!==c?2!==c&&this.handleChangeStatus(1===c?"success":"init",o||1===a&&0===c):i&&i.code&&(this.cancelCheckQrcodeScanStatus(),40321===i.code&&this.setState({status:"error",errorMessage:i.message}))}},{key:"componentWillUnmount",value:function(){this.cancelCheckQrcodeScanStatus()}},{key:"getToken",value:function(){return this.props.getQrcodeLoginToken()}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,a=t.qrcodeLoginToken,c=t.isInSignPage,i=t.showSwitchTypeIcon,o=t.isBlockType,s=this.state,l=s.status,u=s.errorMessage,d=s.guideTypeSymbol,g=null;return g="init"===l?Object(r.c)("div",{className:"Qrcode-content",children:[Object(r.b)("div",{className:"Qrcode-img",children:a?Object(r.b)("img",{className:"Qrcode-qrcode",width:"150",height:"150",src:"//".concat(k.a.wwwHost,"/api/v3/account/api/login/qrcode/").concat(a,"/image").concat(c?"?utm_campaign=internal&utm_medium=qr&utm_source=login&utm_term=force_launch&utm_content=qrscan".concat(d):""),alt:"二维码"}):Object(r.b)(I.a,{count:3})}),Object(r.c)("div",{className:"Qrcode-guide-message",children:[o&&Object(r.b)("div",{className:"Qrcode-title",children:"扫码登录"}),Object(r.b)(m.Box,{mt:"24px",color:"GBK03A",fontSize:14,fontWeight:"bold",lineHeight:"20px",children:"其他扫码方式：微信"})]})]}):"success"===l?Object(r.c)(r.a,{children:[Object(r.c)("div",{className:"Qrcode-content Qrcode-success",children:[Object(r.b)("div",{className:"Qrcode-scanResultStaus",children:Object(r.b)(O,{fill:"#2db370",size:58})}),Object(r.b)("p",{className:"Qrcode-scanResultTips",children:"扫描成功"}),Object(r.b)("p",{children:"请在手机上「确认登录」"})]}),Object(r.b)("div",{className:"Qrcode-cutButton",children:Object(r.b)("span",{role:"button",tabIndex:0,onClick:function(){return e.handleChangeStatus("init")},children:"返回二维码"})})]}):Object(r.c)("div",{className:"Qrcode-content Qrcode-failure",children:[Object(r.b)("div",{className:E()({"Qrcode-scanResultStaus":o}),children:Object(r.b)(Q,{fill:"#ffaa00",size:58})}),o&&Object(r.b)("p",{className:"Qrcode-scanResultTips",children:"扫描失败"}),Object(r.b)("p",{children:u})]}),Object(r.c)("div",{className:E()("Qrcode-container",n),children:[Object(r.b)(m.Box,{color:"GBK03A",fontSize:16,fontWeight:"bold",lineHeight:"23px",children:"打开知乎App"}),Object(r.b)(m.Box,{mt:"8px",mb:"24px",color:"GBK03A",fontSize:14,lineHeight:"20px",children:"在「我的页」左上角打开扫一扫"}),g,i&&Object(r.b)(M,{onClick:this.handleChangeLoginType})]})}}]),n}(p.Component);U.propTypes={type:g.a.string,isShowPasswordLogin:g.a.bool,onChangeType:g.a.func,getQrcodeLoginToken:g.a.func,checkQrcodeScanStatus:g.a.func,isInSignPage:g.a.bool,showSwitchTypeIcon:g.a.bool,isBlockType:g.a.bool},U.defaultProps={qrcodeLoginToken:"",qrcodeLoginScanStatus:"",onChangeType:function(){},showSwitchTypeIcon:!0,isBlockType:!1};var V=Object(f.compose)(b.withRouter,z,Object(A.connect)((function(e,t){var n=e.login;return{qrcodeLoginToken:n.qrcodeLoginToken,qrcodeLoginTokenExpires:n.qrcodeLoginTokenExpires,qrcodeLoginScanStatus:n.qrcodeLoginScanStatus,qrcodeLoginError:n.qrcodeLoginError,qrcodeLoginReturnNewToken:n.qrcodeLoginReturnNewToken,edition:Object(y.b)(e),isSignPage:["/signin","/signup"].includes(t.router.location.pathname)}}),{getQrcodeLoginToken:j.d,checkQrcodeScanStatus:j.a}))(U),L=["isQRCodeShown","onQRCodeLinkClick","zaClickId"],F=function(e){return{padding:"4px 10px",border:"1px solid #EBEBEB",borderRadius:"29px",fontSize:"12px",color:e.colors.GBK03A,lineHeight:"19px",":hover":{background:e.colors.GBK10A},display:"inline-block"}},q=function(e){var t=e.isQRCodeShown,n=void 0!==t&&t,c=e.onQRCodeLinkClick,i=e.zaClickId,o=Object(a.default)(e,L);return Object(r.c)(m.Flex,Object.assign(Object.assign({fontSize:14,color:"GBL01A",height:"60px",alignItems:"center",justifyContent:"center",css:{boxSizing:"border-box",margin:"26px 0 22px"}},o),{},{children:[Object(r.b)(m.Box,{children:Object(r.b)(m.Button,{css:F,bg:"unset",fontWeight:"inherit",mr:"8px",onClick:c,children:n?"关闭二维码":"下载知乎App"})}),Object(r.b)(m.Box,{css:{whiteSpace:"nowrap"},children:Object(r.b)(m.Link,{href:"/org/signup",css:F,mr:"8px","data-za-detail-view-id":i,children:"开通机构号"})}),Object(r.b)(m.Box,{css:{whiteSpace:"nowrap"},children:Object(r.b)(m.Button,{css:F,bg:"unset",fontWeight:"inherit",onClick:function(){var e;null===(e=window.aria)||void 0===e||e.start()},"data-za-detail-view-id":i,children:"无障碍模式"})})]}))},J=n(173),Z=n(191),K=n(32),W=n(35),H=n(105),G=n(300),Y=n(31),X=n(33),_=n(1295),$=function(e){var t=e.onBack,n=e.data,a=n.phoneNo,c=n.code,i=n.targetNo,o=e.onSubmit;return Object(r.c)("div",{className:"SMSIdentify",children:[Object(r.c)("div",{className:"SMSIdentify-back",role:"button",tabIndex:0,onClick:t,children:[Object(r.b)(_.a,{fill:"#8590a6",size:36,center:!0}),"返回"]}),Object(r.b)("div",{className:"SMSIdentify-title",children:"身份验证"}),Object(r.c)("div",{className:"SMSIdentify-tip",children:["请用手机号 ",a.slice(0,-8),"****",a.slice(-4)," 发送短信"]}),Object(r.c)("div",{className:"SMSIdentify-content",children:[Object(r.c)("div",{children:["短信内容",Object(r.b)("span",{children:c})]}),Object(r.c)("div",{children:["发送到号码",Object(r.b)("span",{children:i})]})]}),Object(r.b)("div",{className:"SMSIdentify-submitTip",children:"发送完成后，请点击下方按钮进行校验"}),Object(r.b)(X.c,{className:"SMSIdentify-submit",preset:"primary",color:"blue",onClick:o,children:"我已发送"})]})};function ee(e,t,n){if(t&&!Array.isArray(t)&&"number"==typeof t.length){var a=t.length;return function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}(t,void 0!==n&&n<a?n:a)}return e(t,n)}var te=Object(A.connect)(null,{getSMSIdentify:j.e,postSMSIdentify:j.f,showNotification:Y.h})((function(e){var t=e.getSMSIdentify,n=e.postSMSIdentify,a=e.showNotification,i=e.onBack,o=e.phoneNo,s=Object(p.useState)({code:"",phoneNo:"",targetNo:""}),l=ee(W.a,s,2),u=l[0],d=l[1];Object(p.useEffect)((function(){c.a.trackCardShow(null,{id:5935})}),[]),Object(p.useEffect)((function(){o&&t(o).then((function(e){var t=e.payload;t&&d(t)})).catch((function(e){var t=e.payload;t&&d(t)}))}),[t,o]);var g=$;return Object(r.b)(g,{onBack:i,onSubmit:function(){c.a.trackEvent(null,{id:23456}),n(o).then((function(e){var t=e.payload;c.a.trackEvent(null,{id:6729,action:"Click",name:t.success?"通过":"失败"}),t.success?i():a("没有收到短信，请稍后重试","red")}))},data:u})})),ne=function(e){var t=e.captcha,n=t.captchaNeeded,a=t.captchaValidated,r=t.v2,c=e.login,i=c.loginConfirmSucceeded,o=c.loginConfirmError,s=c.sendDigitsError,l=c.needSMSIdentify,u=c.loginUnregisteredError,d=c.verification,g=e.register;return{loginConfirmSucceeded:i,loginConfirmError:o,sendDigitsError:s,loginUnregisteredError:u,captchaNeeded:n,captchaValidated:a,registerValidateErrors:g.registerValidateErrors,registerConfirmError:g.registerConfirmError,registerConfirmSucceeded:g.registerConfirmSucceeded,needSMSIdentify:l,captchaV2:r,verification:d}},ae=n(299),re=n(1296),ce=Object.assign;var ie=function(e){return h.a.createElement(x.a,ce({width:"52",height:"52",fill:"none",xmlnsXlink:"http://www.w3.org/1999/xlink"},e),h.a.createElement("mask",{id:"id-3757926926-a",width:"52",height:"52",x:"0",y:"0",maskUnits:"userSpaceOnUse"},h.a.createElement("path",{fill:"#fff",d:"M0 0l52 52V0H0z"})),h.a.createElement("g",{mask:"url(#id-3757926926-a)"},h.a.createElement("path",{fill:"#06F",d:"M0 0h48a4 4 0 014 4v48L0 0z"}),h.a.createElement("path",{fill:"url(#pattern0)",d:"M0 0h52v52H0z"})),h.a.createElement("defs",null,h.a.createElement("pattern",{id:"pattern0",width:"1",height:"1",patternContentUnits:"objectBoundingBox"},h.a.createElement("use",{transform:"scale(.00216)",xlinkHref:"#image0"})),h.a.createElement("image",{id:"image0",width:"463",height:"463",xlinkHref:"data:image/png;base64,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"})))},oe=function(e){var t=e.type,n=e.showSwitchTypeIcon,a=Object(ae.b)().handleChangeType;return Object(r.c)("div",{className:"SignFlow-tabs",children:[Object(r.b)(T.a,{as:"div",zaText:"免密码登录",zaType:"Button",zaAction:"Save",className:E()("SignFlow-tab",{"SignFlow-tab--active":"digits"===t}),role:"button",tabIndex:0,onClick:function(){"digits"!==t&&a("digits")},onKeyDown:function(e){Object(re.b)(e)&&"digits"!==t&&a("digits")},children:"验证码登录"}),Object(r.b)(T.a,{as:"div",zaText:"密码登录",zaType:"Button",zaAction:"Save",className:E()("SignFlow-tab",{"SignFlow-tab--active":"password"===t}),role:"button",tabIndex:0,onClick:function(){"password"!==t&&a("password")},onKeyDown:function(e){Object(re.b)(e)&&"password"!==t&&a("password")},children:"密码登录"}),n&&Object(r.b)(T.a,{as:"div",zaText:"二维码图片登录",zaType:"Button",zaAction:"Save",role:"button",tabIndex:0,"aria-label":"二维码图片",className:"SignFlow-qrcodeTab",onClick:function(){a("qrcode")},children:Object(r.b)(ie,{})})]})};oe.propTypes={showSwitchTypeIcon:g.a.bool},oe.defaultProps={showSwitchTypeIcon:!0};var se,le=oe,ue=n(516),de=["type","isOversea","supportedCountriesShown","selectedCountry","username","usernameServerError","customErrorInputMap"],ge=function(e){var t=e.type,n=e.isOversea,c=e.supportedCountriesShown,i=e.selectedCountry,o=e.username,s=e.usernameServerError,l=e.customErrorInputMap,u=(l=void 0===l?{}:l).username,d=Object(a.default)(e,de),g=Object(ae.b)().handleChange;return Object(r.b)(ue.a,Object.assign({type:"digits"===t||c?"digits":"password",supportedCountriesShown:"digits"===t||n,onChange:function(e){return g("username",e)},onSelect:function(e){return g("selectedCountry",e)},defaultSelectedCountry:i,manualValidateError:s||u,defaultValue:o},d))},pe=n(2),he=n(1282),fe=n(1278),Ae=function(e){var t=e.handleRegister,n=e.setState,a=e.usernameServerError,c=e.passwordServerError,i=e.submitDisabled,o=Object(A.useDispatch)(),s=Object(H.a)((function(e){return function(t){return n(Object(pe.a)({},e,t))}}));return Object(r.c)(G.b,{className:"SignFlow-setting",onSubmit:t,children:[Object(r.c)("div",{role:"button",tabIndex:0,className:"SignFlow-back",onClick:function(){return o(j.g.apply(void 0,arguments))},children:[Object(r.b)(_.a,{center:!0,size:28,fill:"#8590a6"}),"返回"]}),Object(r.b)("div",{className:"SignFlow-settingTitle",children:"设置用户名和密码"}),Object(r.b)(he.a,{name:"fullname",placeholder:"用户名",onChange:s("fullname"),manualValidateError:a}),Object(r.b)(fe.a,{onChange:s("password"),placeholderPrefix:"8 位数字或字母",defaultType:"text",manualValidateError:c}),Object(r.b)(X.c,{type:"submit",className:"SignFlow-submitButton",preset:"primary",color:"blue",disabled:i,children:"进入知乎"})]},"setting")},be=n(216),me=n(536),Ce=n(530),Ee=n(314),ve=["countDownEvent","countDownEndEvent","startAtOnce","interceptTime","isEmail","reStartTime","smsType"];function Ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(u.a)(e);if(t){var r=Object(u.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(l.a)(this,n)}}var Be=function(e){Object(s.a)(n,e);var t=Ie(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e,t=this.props,n=t.countDownEvent,c=t.countDownEndEvent,i=t.startAtOnce,o=t.interceptTime,s=t.isEmail,l=t.reStartTime,u=t.smsType,d=Object(a.default)(t,ve);return e=s?"邮箱":"voice"===u?"语音":"短信",Object(r.c)("div",{className:"SignFlow SignFlow-smsInputContainer",children:[Object(r.b)(Ee.a,Object.assign({name:"digits",className:"SignFlow-smsInput",type:"number",smsType:u,errorMessageClassName:"SignFlow-smsInputErrorMessage",placeholder:"输入 6 位".concat(e,"验证码"),validations:[{type:"required",message:"请输入".concat(e,"验证码"),className:"SignFlow-smsInputRequiredErrorMask"}]},d)),Object(r.b)(me.a,{className:"SignFlow-smsInputButton",preset:"plain",initialText:"获取".concat(e,"验证码"),resetText:"重新获取".concat(e,"验证码"),countingText:Object(Ce.a)(se||(se=Object(be.a)([""," 秒后可重发"])),"count"),startAtOnce:i,event:n,countDownEndEvent:c,interceptTime:o,reStartTime:l})]})}}]),n}(p.Component);Be.propTypes={countDownEvent:g.a.func.isRequired,startAtOnce:g.a.bool,interceptTime:g.a.number,reStartTime:g.a.number,isEmail:g.a.bool,countDownEndEvent:g.a.func,smsType:g.a.string},Be.defaultProps={startAtOnce:!1,isEmail:!1};var Se=Be,Oe=["type","smsInputInterceptTime","digitsServerError","smsType","reStartTime","passwordServerError","password"],we=function(e){var t=e.type,n=e.smsInputInterceptTime,c=e.digitsServerError,i=e.smsType,o=e.reStartTime,s=e.passwordServerError,l=e.password,u=Object(a.default)(e,Oe),d=Object(ae.b)(),g=d.handleSendDigits,p=d.setState,h=Object(H.a)((function(){p({smsBackUpDisplay:!0})})),f=Object(H.a)((function(e){return p({digits:e})})),A=Object(H.a)((function(e){return p({password:e})}));return Object(r.c)(r.a,{children:["digits"===t&&Object(r.b)(r.a,{children:Object(r.b)(Se,Object.assign({countDownEvent:g,countDownEndEvent:h,interceptTime:n,manualValidateError:c,smsType:i,reStartTime:o,onChange:f},u))}),"password"===t&&Object(r.b)(r.a,{children:Object(r.b)(fe.a,Object.assign({onChange:A,manualValidateError:s,defaultValue:l},u))})]})},Qe=n(1437),ye=function(e){var t=e.smsBackUpName,n=e.smsBackUpDisplay,a=e.isOverSea,i=e.smsType,o=e.type,s=e.containerType,l=Object(ae.b)(),u=l.handleChangeType,d=l.setState,g=Object(H.a)((function(){c.a.trackEvent(event.currentTarget,{id:4947}),c.a.trackEvent(void 0,{action:"Click",element:"Button",element_name:"ResetPassword"}),window.open("".concat(K.H,"/account/password_reset"),"_blank")})),p=Object(H.a)((function(e){c.a.trackEvent(e.currentTarget,{id:4941}),d({smsType:"text"===i?"voice":"text",smsBackUpName:"text"===i?"短信":"语音",reStartTime:Date.now()})})),h={configMap:{containerType:Object(Qe.b)(s)}};return Object(r.c)("div",{className:"Login-options",children:[Object(r.b)(T.a,{as:X.c,zaText:a?"邮箱帐号登录":"海外手机号登录",zaType:"Button",zaAction:"Expand",extra:h,preset:"plain",className:"Login-switchType",onClick:function(){"digits"!==o&&u(a?"email":"oversea")},children:"digits"!==o&&(a?"邮箱帐号登录":"海外手机号登录")}),Object(r.b)(X.c,{preset:"plain",className:"Login-cannotLogin",onClick:"digits"===o?p:g,children:"digits"===o?n&&Object(r.c)(T.f,{zaType:"Text",zaText:"免密码登录",extra:h,children:["获取",t,"验证码"]},"noPassword"):Object(r.b)(T.f,{zaType:"Text",zaText:"密码登录",extra:h,children:"忘记密码"},"forgetPassword")})]})},je=function(e){var t=e.submitDisabled,n=e.type,a=e.containerType,c=Object(p.useMemo)((function(){return"password"!==n&&k.a.allowSignUp?"登录/注册":"登录"}),[n]);return Object(r.b)(T.a,{as:X.c,zaText:"登录",zaType:"Button",zaAction:"Signin",extra:{configMap:{containerType:Object(Qe.b)(a),signinType:n}},type:"submit",className:"SignFlow-submitButton",preset:"primary",color:"blue",disabled:t,children:c})},ke=n(1087),Te=n(387),Re=n(1438),Ne=n(56),ze=n.n(Ne),xe=n(126),De=n(955),Me=n(1157);function Pe(e,t,n){if(t&&!Array.isArray(t)&&"number"==typeof t.length){var a=t.length;return function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}(t,void 0!==n&&n<a?n:a)}return e(t,n)}function Ue(e,t){var n,a=e.onReady,c=e.onVerify,i=e.onClose,o=Object(A.useSelector)((function(e){return e.captcha})).v2,s=Object(p.useRef)(null),l=Object(De.a)(),u=null==o||null===(n=o.script)||void 0===n?void 0:n[1],d=Object(p.useRef)(null),g=Object(p.useRef)(),h=Object(p.useRef)(),f=Object(p.useState)("init"),b=Pe(W.a,f,2),m=b[0],C=b[1];Object(p.useEffect)((function(){if(null!=o&&o.script){var e=u?ze.a.parse(null==u?void 0:u.split("?")[1]).captchaId:"0";return d.current&&d.current!==e?(l.confirm("页面将自动刷新，请在刷新后重试",{title:"验证码已过期",ok:"刷新"}).then((function(){location.reload()})).catch((function(){s.current&&clearTimeout(s.current)})),s.current=setTimeout((function(){location.reload()}),5e3)):d.current=e,function(){s.current&&clearTimeout(s.current)}}}),[o,u,l]),Object(p.useImperativeHandle)(t,(function(){return{get required(){return Boolean(o)},get ready(){return Boolean(h.current)},get type(){var e;return(null===(e=h.current)||void 0===e?void 0:e.type)||"vendor"},show:function(){var e;null===(e=h.current)||void 0===e||e.show()},close:function(){var e;return null===(e=h.current)||void 0===e?void 0:e.close()},refresh:function(){var e;return null===(e=h.current)||void 0===e?void 0:e.refresh()}}}));var E=Object(H.a)((function(e){var t;if(null!==(t=e.script)&&void 0!==t&&t.length){C("loading");var n=e.script.map((function(e){return function(){return Object(xe.loadScript)(e)}}));Object(Me.b)(n).then((function(){return C("mount"),window.ZS_CAP.init({element:g.current,callback:function(e){null==c||c(e)},enableClose:!0,onClose:i})})).then((function(e){h.current=e,C("ready"),null==a||a()})).catch((function(e){var t;return null===(t=window.Raven)||void 0===t?void 0:t.captureException(e)}))}else C("bypass")}));return Object(p.useEffect)((function(){o&&"init"===m&&E(o)}),[o,m,E]),o?Object(r.b)("div",{ref:g}):null}var Ve=h.a.memo(h.a.forwardRef(Ue)),Le=function(e){var t=e.type,n=e.captchaV2,a=Object(A.useDispatch)();return Object(H.a)((function(){"qrcode"!==t&&(n&&a(Object(Te.d)()),a(Object(Te.a)("captcha_sign_in")))}))},Fe=function(e){var t=e.type,n=e.captchaV2Ref,a=e.onVerify,c=e.lastSubmittedTimestamp,i=Object(A.useDispatch)(),o=Object(ae.b)(),s=o.continueActionRef,l=o.captchaV2,u=Le({type:t,captchaV2:l});Object(p.useEffect)((function(){u(),v.b.increment("logIn.captcha.request.count",.001)}),[u]),Object(ke.a)(["esc"],(function(){var e;null===(e=n.current)||void 0===e||e.close()}));return Object(p.useEffect)((function(){var e;c&&(-1!==c&&(console.log("captcha refresh!"),null===(e=n.current)||void 0===e||e.refresh()))}),[c,n]),Object(r.b)(Ve,{ref:n,onVerify:function(e){if(e instanceof Error)return v.b.increment("logIn.captcha.wrong.count"),i(Object(Y.h)(e.message||"验证失败","red"));if(null==e||!e.type||null==e||!e.result)return i(Object(Y.h)("错误的验证方式","red"));var t=e.result;i(Object(Te.c)(JSON.stringify(t),!0,"captcha_sign_in")).then((function(e){var t,n=e.payload;null!=n&&n.success&&(null==a||a({result:"success"}),null!=s&&s.current&&(null===(t=s.current)||void 0===t||t.call(s)))})).catch((function(e){var t;if(null==a||a({result:"fail"}),"ResponseError"!==(null==e?void 0:e.name)||120001!==(null===(t=e.payload)||void 0===t?void 0:t.code))throw i(Object(Y.h)(Object(Re.b)(e),"red")),e;i(Object(Y.h)("页面已过期，请刷新页面重试","red"))})).finally((function(){var e;s&&(s.current=null),null===(e=n.current)||void 0===e||e.close()}))},onClose:function(){var e;c||(console.log("captcha refresh!"),null===(e=n.current)||void 0===e||e.refresh())}})},qe=n(1208),Je=function(e){var t=e.props,n=e.setState,a=e.state,r=t.onChangeType,i=t.type,o=t.captchaV2,s=Object(A.useDispatch)(),l=a.username,u=Le({props:t});return Object(H.a)((function(e){s(Object(j.g)()),r(e),"qrcode"!==e&&"password"!==e||c.a.trackEvent(null,{action:"Click",name:"qrcode"===e?"使用二维码登录":"使用密码登录"},{account:{type:"Zhihu"}}),"qrcode"!==e&&(n({username:"password"===i&&Object(qe.a)(l)?"":l,smsBackUpDisplay:!0}),o||u())}))},Ze=function(e){var t,n=e.loginConfirmError,a=e.sendDigitsError,r=e.registerValidateErrors,c=(t=n,Object(p.useMemo)((function(){var e=t||{};return{loginUsernameServerError:e.username,passwordServerError:e.password,digitsServerError:e.digits,captchaServerError:e.captcha,undefinedLoginError:e.unknown,validateDigitsError:e.validateDigitsError}}),[t])),i=c.loginUsernameServerError,o=c.passwordServerError,s=c.digitsServerError,l=c.captchaServerError,u=c.undefinedLoginError,d=c.validateDigitsError,g=function(e){return Object(p.useMemo)((function(){var t=e||{};return{sendDigitsUsernameServerError:t.username,undefinedDigitsError:t.unknown}}),[e])}(a),h=g.sendDigitsUsernameServerError,f=g.undefinedDigitsError,A=function(e){return Object(p.useMemo)((function(){var t=e||{},n=t.fullname,a=(n=void 0===n?{}:n).message,r=t.password;return{fullnameError:a,registerPasswordServerError:(r=void 0===r?{}:r).message}}),[e])}(r),b=A.fullnameError,m=A.registerPasswordServerError;return{usernameServerError:h||i,passwordServerError:o||m,digitsServerError:s||d,captchaServerError:l,fullnameError:b,undefinedLoginError:u,undefinedDigitsError:f}},Ke=function(e){var t=e.setState,n=Object(A.useDispatch)();return Object(H.a)((function(e,a){n(Object(j.g)()),t(Object(pe.a)({},e,a))}))},We=function(e){var t=e.state,n=t.selectedCountry.code,a=t.username;return Object(H.a)((function(){return"+86"!==n||/^\d{11}$/.test(a)}))},He=n(287),Ge=n(416);function Ye(e,t){if(!e)return{};var n,a=e=e.trim(),r=Object(qe.a)(e);if(!r){var c={hasCode:(n=e).startsWith("+")||n.startsWith("00"),parsedPhoneNo:n.startsWith("00")?"+".concat(n.slice(2)):n};a=c.hasCode?c.parsedPhoneNo:"".concat(t).concat(e)}return{value:a,isEmail:r}}var Xe=function(e){var t=e.props,n=e.setState,a=e.runBeforeResetValidateResult,r=e.runBeforeCheckCaptcha,i=e.testPhoneNo,o=e.continueActionRef,s=e.selectedCountry,l=e.captcha,u=e.customErrorInputMap,d=e.username,g=e.trackLoginSuccess,p=t.type,h=t.isOverSea,f=t.nextUrl,b=Object(A.useDispatch)();return Object(H.a)((function(e){c.a.trackEvent(void 0,{id:4948}),a((function(){if("digits"!==p&&!h||i()){v.b.increment("logIn.clickLogInBtn.count",.1);var t=function(){var t=Object(He.c)(f),a=t.utm_source,r=t.utm_medium,c=Object.assign(Object.assign({},e),{},{username:Ye(e.username,s.code).value,captcha:l,utmSource:a,refSource:r});n({lastSubmittedTimestamp:Date.now()}),b(Object(j.i)(Object(Ge.a)(p,c))).then((function(e){var t;null!==(t=e.payload)&&void 0!==t&&t.accessToken&&(null==g||g())}))};o.current=t,r().then((function(e){e&&t()})).finally((function(){return n({submitDisabled:!1})}))}else n({customErrorInputMap:Object.assign(Object.assign({},u),{},{username:d?"请输入正确的手机号":"请输入手机号"}),smsInputInterceptTime:Date.now()})}))}))},_e=function(e){var t=document.querySelectorAll(".yidun_modal"),n=function(e){var t,n=document.createElement("button");return n.style.position="absolute",n.style.top="15px",n.style.right="15px",n.style.fontSize="16px",n.innerText="✕",n.setAttribute("tabindex","0"),n.addEventListener("click",e),(t=n)&&(t.addEventListener("focus",(function(e){e.target.style.boxShadow="0 0 0 2px #ffffff, 0 0 0 4px rgb(0 102 255 / 30%)"}),!0),t.addEventListener("blur",(function(e){e.target.style.boxShadow="none"}),!0)),n}((function(){var t;return null===(t=e.current)||void 0===t?void 0:t.close()}));Array.from(t).forEach((function(e){e.appendChild(n),function(e){e.querySelector(".yidun_tips").removeAttribute("aria-live")}(e),function(e){var t=e.querySelector(".yidun_modal__title");t.setAttribute("tabindex","-1"),t.innerText="请完成安全验证，可使用语音验证",t.addEventListener("focus",(function(){t.style.outline="none"})),setTimeout((function(){t.focus()}),500)}(e)}))},$e=function(e){var t=e.customErrorInputMap,n=e.smsType,a=e.selectedCountry.code,r=e.username,c=e.testPhoneNo,i=e.captchaV2Ref,o=e.runBeforeResetValidateResult,s=e.setState,l=e.captchaNeeded,u=e.continueActionRef,d=Object(A.useDispatch)();return Object(H.a)((function(e,g){return o((function(){var e;if(c()){var o=Ye(r,a).value,p=function(){d(Object(j.h)(o,n)),s({smsBackUpDisplay:!1})};if(!r||l){if(l&&null!==(e=i.current)&&void 0!==e&&e.required){i.current.show(),_e(i);return u.current=function(){p(),g()},!1}s({customErrorInputMap:Object.assign(Object.assign({},t),{},{username:r?"":"请输入手机号"})})}else p()}else s({customErrorInputMap:Object.assign(Object.assign({},t),{},{username:r?"请输入正确的手机号":"请输入手机号"}),smsInputInterceptTime:Date.now()})}),!l)}))},et={username:null,password:null,captcha:null,digits:null},tt=function(e){var t=e.setState,n=Object(A.useDispatch)();return Object(H.a)((function(e,a){return n(Object(j.g)()),t({customErrorInputMap:Object.assign({},et),validationResult:{needsRefresh:!1,timestamp:Date.now()}},e),a}))},nt=function(e){var t=e.props,n=e.captchaV2Ref,a=t.captchaValidated,r=t.captchaNeeded;return Object(H.a)((function(){if(!a&&r){var e;if(null!==(e=n.current)&&void 0!==e&&e.required)return n.current.show(),_e(n),Promise.resolve(!1);console.warn("Captcha is unavailable.")}return Promise.resolve(!0)}))},at=n(331),rt=n(522),ct=function(e){var t=e.registerConfirmSucceeded,n=e.loginConfirmSucceeded,a=e.sendDigitsError,r=e.nextUrl,c=e.username,i=e.isInSignPage,o=e.loginConfirmError,s=e.setState,l=e.loginUnregisteredError,u=e.loginBindWechatError,d=e.type,g=e.verification,h=Object(A.useDispatch)();Object(p.useEffect)((function(){!o||l||u||(h(Object(Te.e)(d)),h(Object(Te.a)()))}),[o,l,u,s,h,d]),Object(p.useEffect)((function(){(n||t)&&(Object(rt.b)(c),null!=g&&g.isZombie&&Object(at.c)(g),r?location.href=r:i?location.href="/":location.reload())}),[n,t]),Object(p.useEffect)((function(){if(a||!1===n){var e=a?{smsInputInterceptTime:Date.now()}:{};s(Object.assign(Object.assign({},e),{},{captchaValidated:!1,captchaNeeded:!0}))}}),[a,n]),Object(p.useEffect)((function(){a&&null===o&&s({smsBackUpDisplay:!0})}),[a])},it="UPDATE_STATE",ot=function(e){return{smsType:"text",smsBackUpName:"语音",smsBackUpDisplay:!0,reStartTime:-1,supportedCountriesShown:!1,selectedCountry:e.selectedCountry,username:e.username,password:e.password,fullname:"",customErrorInputMap:Object.assign({},et),submitDisabled:!1,lastSubmittedTimestamp:-1}},st=function(e,t){var n=t.type,a=t.callback;if(n===it){var r=t.payload;return a&&a(e),Object.assign(Object.assign({},e),r)}return e},lt=n(509),ut=function(e){var t=e.props,n=e.captchaV2Ref,a=e.continueActionRef,r=e.setState,c=e.selectedCountry.code,i=e.username,o=e.fullname,s=e.digits,l=e.password,u=Object(A.useDispatch)(),d=nt({props:t,captchaV2Ref:n});return Object(H.a)((function(){var e=function(){u(Object(lt.d)({source:"com.zhihu.web",registerType:"phone_digits",phoneNo:"".concat(c).concat(i),fullname:o,digits:s,password:l}))};a&&(a.current=e),r({submitDisabled:!0}),d().then((function(t){return t&&e()})).finally((function(){return r({submitDisabled:!1})}))}))};function dt(e,t,n){if(t&&!Array.isArray(t)&&"number"==typeof t.length){var a=t.length;return function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}(t,void 0!==n&&n<a?n:a)}return e(t,n)}var gt=function(e){var t=e.isInSignPage,n=e.type,a=e.isOversea,c=e.needSMSIdentify,i=e.captchaV2,o=e.registerConfirmSucceeded,s=e.loginConfirmSucceeded,l=e.nextUrl,u=e.captchaNeeded,d=e.loginUnregisteredError,g=e.loginConfirmError,h=e.showSwitchTypeIcon,f=e.isSignPage,b=e.selectClassName,m=e.verification,C=e.containerType,E=Object(A.useDispatch)(),v=Object(p.useReducer)(st,e,ot),I=dt(W.a,v,2),B=I[0],S=I[1],O=B.selectedCountry,w=B.username,Q=B.supportedCountriesShown,y=B.customErrorInputMap,k=B.smsInputInterceptTime,R=B.smsType,N=B.reStartTime,z=B.password,x=B.smsBackUpDisplay,D=B.smsBackUpName,M=B.submitDisabled,P=B.captcha,U=B.fullname,L=B.digits,F=B.lastSubmittedTimestamp,q=Object(p.useRef)(null),J=Object(p.useRef)(null),Z=Object(p.useRef)(null),K=Object(T.l)().trackEvent,X=Object(H.a)((function(){f||K({block:"".concat(n,"_loginSuccess")})})),_=Object(H.a)((function(e,t){return S({type:it,payload:e,callback:t})})),$=Ze(e),ee=$.usernameServerError,ne=$.digitsServerError,re=$.passwordServerError,ce=$.undefinedLoginError,ie=$.undefinedDigitsError;Object(p.useEffect)((function(){(ce||ie)&&E(Object(Y.h)(ce||ie,"red"))}),[E,ce,ie]);var oe=Je({props:e,state:B,setState:_,rootRef:Z}),se=Ke({setState:_}),ue=We({state:B}),de=tt({setState:_}),pe=$e({customErrorInputMap:y,smsType:R,selectedCountry:O,username:w,runBeforeResetValidateResult:de,testPhoneNo:ue,setState:_,captchaNeeded:u,captchaV2Ref:J,continueActionRef:q}),he=nt({props:e,captchaV2Ref:J}),fe=Xe({props:e,selectedCountry:O,captcha:P,setState:_,runBeforeResetValidateResult:de,runBeforeCheckCaptcha:he,testPhoneNo:ue,continueActionRef:q,customErrorInputMap:y,username:w,trackLoginSuccess:X});ct({registerConfirmSucceeded:o,loginConfirmSucceeded:s,nextUrl:l,username:w,isInSignPage:t,loginConfirmError:g,setState:_,loginUnregisteredError:d,verification:m});var be=ut({props:e,captchaV2Ref:J,continueActionRef:q,setState:_,selectedCountry:O,username:w,fullname:U,digits:L,password:z});if(c)return Object(r.b)(te,{ref:Z,onBack:function(){return E(Object(j.g)())},phoneNo:"".concat(O.code).concat(w)});var me=null;if("qrcode"===n){var Ce=Object(r.b)(T.f,{zaType:"Text",zaText:"二维码登录",extra:{configMap:{containerType:"登录页"}},children:Object(r.b)(V,{ref:Z,isInSignPage:t,className:"SignInQrcode",onChangeType:function(){return oe("password")},showSwitchTypeIcon:h,trackLoginSuccess:X})});me=f?Ce:Object(r.b)(T.f,{zaType:"Popup",zaBlock:n,children:Ce},n)}else if(d&&"digits"==n)me=Object(r.b)(Ae,{handleRegister:be,setState:_,submitDisabled:M,usernameServerError:ee,passwordServerError:re});else{var Ee=Object(r.c)(G.b,{className:"SignFlow Login-content",onSubmit:fe,children:[Object(r.b)(le,{type:n,showSwitchTypeIcon:h}),Object(r.b)(ge,{type:n,isOversea:a,supportedCountriesShown:Q,selectedCountry:O,username:w,usernameServerError:ee,customErrorInputMap:y,targetClassName:"username-input"}),Object(r.b)(we,{type:n,smsInputInterceptTime:k,digitsServerError:ne,smsType:R,reStartTime:N,passwordServerError:re,password:z,targetClassName:"username-input"}),Object(r.b)(ye,{type:n,isOverSea:a,smsBackUpName:D,smsBackUpDisplay:x,smsType:R,containerType:C}),Object(r.b)(Fe,{type:n,captchaV2Ref:J,lastSubmittedTimestamp:F}),Object(r.b)(je,{submitDisabled:M,type:n,containerType:C})]});me=f?Object(r.b)(T.f,{zaType:"Popup",zaBlock:n,children:Ee},n):Ee}return Object(r.b)(ae.a,{handleChangeType:oe,setState:_,dispatch:S,selectClassName:b,handleChange:se,testPhoneNo:ue,handleSendDigits:pe,continueActionRef:q,captchaNeeded:u,captchaV2:i,children:me})};gt.propTypes={validateAndLogin:g.a.func,resetLoginValidateResult:g.a.func,loginConfirmSucceeded:g.a.bool,loginConfirmError:g.a.object,selectClassName:g.a.string,sendDigitsError:g.a.object,captchaNeeded:g.a.bool,selectedCountry:g.a.object,username:g.a.string,password:g.a.string,type:g.a.oneOf(["password","digits","qrcode"]),onChangeType:g.a.func,isInSignPage:g.a.bool,showSwitchTypeIcon:g.a.bool},gt.defaultProps={selectedCountry:{name:"中国",code:"+86"},username:"",password:""};var pt=Object(A.connect)(ne)(gt);function ht(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(u.a)(e);if(t){var r=Object(u.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(l.a)(this,n)}}var ft=function(e){Object(s.a)(n,e);var t=ht(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={type:e.props.showQrcodeFirst?"qrcode":"digits",isOversea:!1,passwordType:"email"},e.handleSwitchLoginType=function(t){"email"!==t&&"oversea"!==t?(e.setState({type:t}),v.b.increment("logIn.type.switchTo.".concat(t,".count"),.001)):e.setState({type:"password",isOversea:"oversea"===t,passwordType:t})},e}return Object(o.a)(n,[{key:"renderNotification",value:function(){var e=this.props,t=e.notification,n=e.account,a=n.isAppealed,c=n.spamLevel,i=a||c?K.N:K.M,o=null;return o=6===c?Object.assign(Object.assign({},t),{},{theme:"red"}):t,Object(r.b)(Z.a,{notification:o.global,delay:i,className:"AppHeader-notification"})}},{key:"render",value:function(){var e=this.props,t=e.nextUrl,n=e.isInSignPage,a=e.showSwitchTypeIcon,c=e.isSignPage,i=e.selectClassName,o=void 0===i?"Select-popoverTarget":i,s=e.containerType,l=this.state,u=l.type,d=l.isOversea;return Object(r.c)(r.a,{children:[Object(r.b)(pt,{containerType:s,type:u,isInSignPage:n,isOversea:d,onChangeType:this.handleSwitchLoginType,nextUrl:t,showSwitchTypeIcon:a,isSignPage:c,selectClassName:o}),this.renderNotification()]})}}]),n}(p.Component);ft.propTypes={nextUrl:g.a.string,isInSignPage:g.a.bool,showSwitchTypeIcon:g.a.bool,selectClassName:g.a.string};var At=Object(f.compose)(b.withRouter,Object(A.connect)((function(e,t){var n=t.showQrcode,a=void 0===n||n,r=t.showQrcodeFirst;return{showQrcodeFirst:a&&r,notification:e.notification,account:e.account,isSignPage:["/signin","/signup"].includes(t.router.location.pathname)}})))(ft),bt=n(170),mt=n(1439),Ct=n(1610),Et=n(1440),vt=n(160),It=n.n(vt),Bt=n(473),St=n(250),Ot={sina:"Weibo",qq:"QQ",wechat:"Wechat"};function wt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(u.a)(e);if(t){var r=Object(u.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(l.a)(this,n)}}var Qt="/oauth/account_callback",yt={qqconn:"/oauth/redirect/login/qqconn?next=",sina:"/oauth/redirect/login/sina?next=",wechat:"/oauth/redirect/login/wechat?next="};function jt(e){return"sina"!==e||!/WindowsWechat/.test(navigator.userAgent)}var kt=function(e){Object(s.a)(n,e);var t=wt(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).handleCallbackMessage=function(t){var n=t.origin,a=t.data;/(\.)?(zhihu|vzuu)\.(com|dev)/.test(n)&&a&&(e.unsubscribeCallback(),e.accountCallback(a))},e.accountCallback=function(t){var n=e.props.dispatch,a=t.login,r=t.verification,c=t.is_register;if(e.dbg&&alert("收到跨窗口消息:  ".concat(JSON.stringify(t))),void 0!==c){var i=t.code,o=t.msg;return"200"===i?(Object(St.c)(),n(Object(Y.h)("注册成功！")),void setTimeout((function(){return e.reload()}),1e3)):void n(Object(Y.h)(o||"网络存在异常，请您稍后再试","red"))}null!=r&&r.isZombie&&Object(at.c)(r),a&&(Object(rt.b)(e.clickedServiceName),e.handleLogSocialLoginSuccess(),e.reload())},e.handleBuildSocialAuthLink=function(t){e.clickedServiceName=t,e.handleLogSingleSocialButtonClick(t),v.b.increment("logIn.clickSocial.".concat(t,".count"),.1);var n=yt[t],a=Object(He.c)(),r=a.utm_source,c=a.utm_medium;jt(t)?(e.subscribeCallback(),window.open("https://www.zhihu.com".concat(n).concat(Qt).concat(r?"&utm_source=".concat(r):"","&ref_source=").concat(c),"_blank","top=200,left=400,width=600,height=550,directories=no,menubar=no,toolbar=no")):location.href="https://www.zhihu.com".concat(n).concat(Qt,"&from=").concat(encodeURIComponent(e.parseNextInfoFromUrl()))},e.handleEntranceButtonClick=function(t){e.props.onEntranceButtonClick&&e.props.onEntranceButtonClick(t),e.handleLogSocialLogin(),e.setState((function(e){return{socialButtonExpanded:!e.socialButtonExpanded}}))},e.parseNextInfoFromUrl=function(){var t=e.props.router.location.query.next,n="/";if(t)try{n=decodeURIComponent(t)}catch(e){n=unescape(t)}return n},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){if(document.referrer.startsWith("https://www.zhihu.com/oauth/callback/sina")){var e=It.a.get("atoken"),t=It.a.get("accountcallback");if(e&&t){var n=JSON.parse(decodeURIComponent(t));if(!n)return;var a=n.fullname,r=n.type;(0,this.props.onRegister)({fullname:a,socialType:r})}}}},{key:"componentWillUnmount",value:function(){this.unsubscribeCallback()}},{key:"dbg",get:function(){return this.props.office&&"undefined"!=typeof window&&localStorage.getItem("dbg")}},{key:"subscribeCallback",value:function(){window.addEventListener("message",this.handleCallbackMessage,!1),window.NWEB={accountCallback:this.accountCallback},this.domain=document.domain,document.domain="zhihu.com"}},{key:"unsubscribeCallback",value:function(){if(window.removeEventListener("message",this.handleCallbackMessage,!1),window.NWEB&&"www.zhihu.com"===location.host){try{document.domain=this.domain}catch(e){}delete window.NWEB}}},{key:"reload",value:function(){var e=this.parseNextInfoFromUrl();e?location.href=e:location.reload()}},{key:"handleLogSocialLogin",value:function(){c.a.trackEvent(this,{action:"Click",element:"Button",element_name:"SNSSignIn"})}},{key:"handleLogSingleSocialButtonClick",value:function(e){var t,n,a,r;t=this,n="SignIn",a={type:Ot[e]},c.a.trackEvent(t,{action:n,element:"Button",element_name:r},{account:a})}},{key:"handleLogSocialLoginSuccess",value:function(){var e,t,n,a,r=this.props,i=r.router,o=r.trackEvent;["/signin","/signup"].includes(i.location.pathname)||o({block:"".concat(this.clickedServiceName,"_loginSuccess")}),e=this,t="SignIn",n=this.clickedServiceName,c.a.trackEvent(e,{id:236,action:"StatusReport",element_name:a},{status:{result:"Success",event:{action:t,element:"Button"}},account:n})}},{key:"render",value:function(){var e=this;return Object(r.b)("div",{className:"Login-socialLogin",children:Object(r.c)("span",{className:"Login-socialButtonGroup",children:[Object(r.b)(T.a,{as:X.c,zaText:"微信第三方登录",zaType:"Button",zaAction:"OpenUrl",extra:{link:{url:"https://open.weixin.qq.com/connect/qrconnect"}},className:"Login-socialButton",preset:"plain",onClick:function(){return e.handleBuildSocialAuthLink("wechat")},children:Object(r.b)(mt.c,{})}),Object(r.b)(T.a,{as:X.c,zaText:"QQ第三方登录",zaType:"Button",zaAction:"OpenUrl",extra:{link:{url:"https://graph.qq.com/oauth2.0/show"}},className:"Login-socialButton",preset:"plain",onClick:function(){return e.handleBuildSocialAuthLink("qqconn")},children:Object(r.b)(Ct.b,{fill:"#50C8FD"})}),Object(r.b)(T.a,{as:X.c,zaText:"微博第三方登录",zaType:"Button",zaAction:"OpenUrl",extra:{link:{url:"https://api.weibo.com/oauth2/authorize"}},className:"Login-socialButton",preset:"plain",onClick:function(){return e.handleBuildSocialAuthLink("sina")},children:Object(r.b)(Et.b,{})})]})})}}]),n}(p.Component);kt.propTypes={onRegister:g.a.func.isRequired,onEntranceButtonClick:g.a.func};var Tt=Object(f.compose)(b.withRouter,z)(kt);function Rt(e){var t=Object(bt.b)(),n=Object(A.useDispatch)(),a=Object(Bt.a)();return/bux/.test(t.origin)?null:Object(r.b)(Tt,Object.assign(Object.assign({},e),{},{dispatch:n,office:a}))}n(1427);var Nt=n(1902),zt=n(866);function xt(e){var t=e.captchaNeeded,n=e.sendDigitsError,a=e.registerConfirmError;return function(e){var t=e.captchaNeeded,n=e.sendDigitsError,a=Object(A.useDispatch)(),r=Object(zt.a)(n);Object(p.useEffect)((function(){n&&!r&&a(t?Object(Te.e)():Object(Te.a)("captcha_sign_in"))}),[a,n,r,t])}({captchaNeeded:t,sendDigitsError:n}),function(e){var t=Object(A.useDispatch)(),n=(e||{}).unknown,a=Object(zt.a)(n);Object(p.useEffect)((function(){a!==n&&t(Object(Y.h)(n,"red"))}),[t,n,a])}(a),null}function Dt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(u.a)(e);if(t){var r=Object(u.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(l.a)(this,n)}}var Mt={phoneNoError:null,fullnameError:null,digitsError:null},Pt=function(e){Object(s.a)(n,e);var t=Dt(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={fullname:e.props.defaultFullname||"",avatarPath:"",phoneNo:"",digits:"",captcha:"",isRegister:null,smsBackUpDisplay:!0,smsType:"text",selectedCountry:{name:"中国",code:"+86"},smsInputInterceptTime:-1,reStartTime:-1,customErrorInputMap:Object.assign({},Mt),validationResult:{}},e.captchaV2Ref=Object(p.createRef)(),e.getSocialInfo=function(t){var n=t||e.props,a=n.getSocialInfo,r=n.socialType;r&&a(r).then((function(t){var n=t.payload,a=n.name,r=n.profileImageUrl;e.setState({avatarPath:r.split("/").reverse()[0],fullname:a})}))},e.testPhoneNo=function(){var t=e.state,n=t.selectedCountry.code,a=t.phoneNo;return"+86"!==n||/^\d{11}$/.test(a)},e.handleChange=function(t){return function(n){e.setState(Object(pe.a)({},t,n))}},e.handleBackUpDigits=function(){e.setState({smsType:"text"===e.state.smsType?"voice":"text",reStartTime:Date.now()})},e.handleCountDownEndEvent=function(){e.setState({smsBackUpDisplay:!0})},e.parseServerError=function(t){var n=t||e.props,a=n.registerValidateErrors,r=n.loginConfirmError,c=n.registerConfirmError,i=n.sendDigitsError,o=r||{},s=o.username,l=o.password,u=o.digits,d=o.captcha,g=c||{},p=g.username,h=g.password,f=g.digits,A=i||{},b=A.username,m=A.captcha,C=(a||{}).fullname;return{usernameServerError:s||b,passwordServerError:l||h,digitsServerError:u||f,captchaServerError:d||m,fullnameServerError:(C=void 0===C?{}:C).message||p}},e.runBeforeCheckCaptcha=function(t){var n=e.props,a=n.captchaNeeded,r=n.captchaValidated,c=e.state.phoneNo;if(c&&e.testPhoneNo())return a&&!r?(e.showCaptcha(),void _e(e.captchaV2Ref)):void t();e.setState({customErrorInputMap:Object.assign(Object.assign({},e.state.customErrorInputMap),{},{phoneNoError:c?"请输入正确的手机号":"请输入手机号"}),smsInputInterceptTime:Date.now()})},e.runBeforeResetValidateResult=function(t){e.setState({customErrorInputMap:Object.assign({},Mt)},(function(){t()}))},e.handleSendDigits=function(t,n){return e.countDownStart=n,e.runBeforeCheckCaptcha(e.sendDigits),!1},e.sendDigits=function(){var t,n,a=e.state,r=a.selectedCountry,c=a.phoneNo,i=a.smsType,o=e.props.sendLoginDigits;null===(t=(n=e).countDownStart)||void 0===t||t.call(n),e.props.validateRegisterForm({phoneNo:"".concat(r.code).concat(c)}).then((function(t){var n=t.payload;e.setState({smsBackUpDisplay:!1,isRegister:!(n.phoneNo&&n.phoneNo.code===K.u)}),o("".concat(r.code).concat(c),i)}))},e.handleSubmit=function(){e.runBeforeCheckCaptcha((function(){e.runBeforeResetValidateResult((function(){var t=e.state,n=t.selectedCountry,a=t.phoneNo,r=t.digits,c=t.isRegister,i=t.fullname,o=t.avatarPath,s=e.props,l=s.validateAndLogin,u=s.validateAndRegister,d=s.nextUrl,g=s.socialType,p=Object(He.c)(d),h=p.utm_source,f=p.utm_medium;c?u(Object.assign(Object.assign({source:"com.zhihu.web",registerType:"phone_digits",phoneNo:"".concat(n.code).concat(a),fullname:i,digits:r,refSource:f,utmSource:h},o&&{avatarPath:o}),g&&{socialRegisterType:g})):l(Object(Ge.a)("digits",{username:"".concat(n.code).concat(a),digits:r,refSource:f,utmSource:h}))}))}))},e.onVerify=function(t){"success"===t.result&&e.sendDigits()},e.showCaptcha=function(){var t;null===(t=e.captchaV2Ref.current)||void 0===t||t.show(),e.props.showNotification(e.state.validationResult.message,"red")},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){if(It.a.get("atoken")){this.getSocialInfo();var e=It.a.get("accountcallback");if(!this.state.fullname&&e){var t=JSON.parse(decodeURIComponent(e));this.setState({fullname:t.fullname})}}else this.props.onResetRegister()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.nextUrl,a=t.socialType,r=t.defaultFullname,c=t.sendDigitsError,i=t.loginConfirmError,o=t.loginConfirmSucceeded,s=t.registerConfirmSucceeded,l=e.socialType,u=e.defaultFullname,d=e.sendDigitsError,g=e.loginConfirmError,p=e.loginConfirmSucceeded,h=e.registerConfirmSucceeded;if(!a&&l&&this.getSocialInfo(e),r!==u&&this.setState({fullname:u}),!o&&p||!s&&h)n?location.href=n:location.reload();else if(!i&&g&&g.validateDigitsError&&this.setState({customErrorInputMap:Object.assign(Object.assign({},this.state.customErrorInputMap),{},{digitsError:g.validateDigitsError}),smsInputInterceptTime:Date.now()}),!c&&d){var f=this.parseServerError(e).captchaServerError;this.setState({validationResult:{message:f},smsInputInterceptTime:Date.now()})}}},{key:"render",value:function(){var e=this.state,t=e.smsInputInterceptTime,n=e.customErrorInputMap,a=e.smsBackUpDisplay,c=e.reStartTime,i=e.isRegister,o=e.smsType,s=e.fullname,l=this.props,u=l.onResetRegister,d=l.captchaNeeded,g=l.sendDigitsError,p=l.registerConfirmError,h=n.phoneNoError,f=n.digitsError,A=this.parseServerError(),b=A.usernameServerError,m=A.fullnameServerError,C=A.digitsServerError,v=Object(r.c)(G.b,{className:"Register-content",onSubmit:this.handleSubmit,children:[Object(r.b)(xt,{captchaNeeded:d,sendDigitsError:g,registerConfirmError:p}),Object(r.b)("div",{className:"Register-socialHeader",children:Object(r.c)("div",{className:"Register-socialTitle",children:[Object(r.b)(X.c,{onClick:u,children:Object(r.b)(Nt.a,{})}),"绑定手机"]})},"header"),Object(r.b)(he.a,{className:E()("Register-socialName",{"Register-hiddenSocialName":!i}),name:"fullname",placeholder:"用户名",value:s,onChange:this.handleChange("fullname"),manualValidateError:m,validations:[],targetClassName:"username-input"},"fullname"),Object(r.b)(ue.a,{type:"register",onChange:this.handleChange("phoneNo"),onSelect:this.handleChange("selectedCountry"),manualValidateError:h||b,targetClassName:"username-input"}),Object(r.b)(Fe,{captchaV2Ref:this.captchaV2Ref,onVerify:this.onVerify}),Object(r.b)(Se,{smsType:o,reStartTime:c,onChange:this.handleChange("digits"),countDownEvent:this.handleSendDigits,countDownEndEvent:this.handleCountDownEndEvent,interceptTime:t,manualValidateError:f||C,targetClassName:"username-input"}),Object(r.b)("div",{className:E()("Register-smsBackUp",{"Register-hiddenSmsBackUp":!a}),children:Object(r.c)("span",{role:"button",tabIndex:0,onClick:this.handleBackUpDigits,children:["获取","text"===o?"语音":"短信","验证码"]})}),Object(r.b)(X.c,{className:"Register-submitButton",type:"submit",preset:"primary",color:"blue",children:"进入知乎"})]});return Object(r.b)(ae.a,{children:v})}}]),n}(p.Component),Ut=Object(A.connect)((function(e){var t=e.captcha,n=t.captchaNeeded,a=t.captchaValidated,r=e.register,c=r.registerConfirmError,i=r.registerValidateErrors,o=r.registerConfirmSucceeded,s=e.login,l=s.loginConfirmSucceeded,u=s.validateDigitsError,d=s.loginConfirmError;return{captchaNeeded:n,captchaValidated:a,sendDigitsError:s.sendDigitsError,registerConfirmError:c,registerValidateErrors:i,registerConfirmSucceeded:o,loginConfirmSucceeded:l,validateDigitsError:u,loginConfirmError:d}}),{showNotification:Y.h,sendLoginDigits:j.h,validateAndLogin:j.i,validateAndRegister:lt.d,getSocialInfo:lt.b,validateRegisterForm:lt.e})(Pt);n(1297);function Vt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(u.a)(e);if(t){var r=Object(u.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(l.a)(this,n)}}var Lt=function(e){Object(s.a)(n,e);var t=Vt(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,c=new Array(a),o=0;o<a;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).state={showHeader:!0,fullname:"",socialType:""},e.changeSignType=function(t){e.props.onChangeSignType(t),e.handleSetShowHeader(!0)},e.handleSetShowHeader=function(t){e.setState({showHeader:t})},e.handleSocialRegister=function(t){var n=t.fullname,a=t.socialType;e.props.onChangeSignType("register"),e.setState({fullname:n,socialType:a,showHeader:!1})},e.handleResetRegister=function(){e.props.onChangeSignType("login"),e.setState({fullname:"",socialType:"",showHeader:!0})},e.renderLine=function(){return Object(r.c)(m.Flex,{css:{margin:"0 24px 12px",alignItems:"center"},children:[Object(r.b)(m.Box,{sx:{borderTop:"1px solid",borderColor:"GBK09A",width:"124px"}}),Object(r.b)(m.Text,{color:"GBK06A",fontSize:12,mx:16,width:72,overflow:"hidden",lineHeight:"17px",css:{whiteSpace:"nowrap"},children:"其他方式登录"}),Object(r.b)(m.Box,{sx:{borderTop:"1px solid",borderColor:"GBK09A",width:"124px"}})]})},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.nextUrl;e.isLogin&&(location.href=t||"/")}},{key:"render",value:function(){var e=this.state,t=e.fullname,n=e.socialType,a=this.props,c=a.nextUrl,i=a.isInSignPage,o=a.signType,s=a.showQrcodeFirst,l=a.showSwitchTypeIcon,u=a.containerType,d=i?m.Card:m.Box;return Object(r.c)(d,{bg:"background",width:400,css:{overflow:"hidden",boxShadow:"none"},children:["login"===o?Object(r.b)("div",{className:"SignContainer-content",children:Object(r.b)("div",{className:"SignContainer-inner",children:Object(r.b)(At,{containerType:u,showQrcodeFirst:s,nextUrl:c,isInSignPage:i,showSwitchTypeIcon:l})})}):Object(r.b)(Ut,{socialType:n,nextUrl:c,defaultFullname:t,onResetRegister:this.handleResetRegister}),"login"===o&&Object(r.c)(r.a,{children:[this.renderLine(),Object(r.b)(Rt,{onRegister:this.handleSocialRegister}),Object(r.c)("div",{className:"SignContainer-tip",children:[k.a.allowSignUp?"未注册手机验证后自动登录，注册即代表同意":"手机验证后自动登录，登录即代表同意",Object(r.b)("a",{href:"https://www.zhihu.com/term/zhihu-terms",children:"《知乎协议》"}),Object(r.b)("a",{href:"https://www.zhihu.com/term/privacy",children:"《隐私保护指引》"})]})]})]})}}]),n}(p.Component),Ft=Object(J.a)(Lt),qt=["signType","handleQRCodeLinkClick","isInSignPage","showQrcode"];function Jt(e){var t=e.signType,n=e.handleQRCodeLinkClick,i=e.isInSignPage,o=e.showQrcode,s=Object(a.default)(e,qt);return Object(r.c)("div",{className:"signQr-container",children:[Object(r.c)("div",{className:"signQr-leftContainer",children:[Object(r.b)(V,{className:"smallVersion",showSwitchTypeIcon:!1}),Object(r.b)(q,{zaClickId:i?4943:8270,isQRCodeShown:o,onQRCodeLinkClick:function(e){n(!o),i?o&&c.a.trackEvent(e.currentTarget,{id:4945}):c.a.trackEvent(e.currentTarget,{id:o?8272:8271})}})]}),Object(r.b)("div",{className:"signQr-rightContainer",children:Object(r.b)(Ft,Object.assign({signType:t,showSwitchTypeIcon:!1,isInSignPage:i},s))})]})}},1902:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(0),r=n.n(a),c=n(12),i=Object.assign;function o(e){return r.a.createElement(c.a,i(i({width:"16",height:"16",viewBox:"0 0 16 16","data-new-api":"ArrowLeft16","data-old-api":"ArrowLeft16"},e),{className:"ZDI ZDI--ArrowLeft16"+(e.className?" ".concat(e.className):"")}),r.a.createElement("path",{d:"M11.46 1.54a.65.65 0 010 .92L5.92 8l5.54 5.54a.65.65 0 11-.92.92L4.73 8.648a.917.917 0 010-1.296l5.81-5.812a.65.65 0 01.92 0z",fillRule:"evenodd",clipRule:"evenodd"}))}},955:function(e,t,n){"use strict";var a=n(35),r=n(37),c=n(1),i=n(0),o=n(59),s=n(95),l=n(33),u=n(146),d=n.n(u),g=n(170),p=n(472),h=["title","content","ok","cancel","onOk","onCancel"];function f(e,t,n){if(t&&!Array.isArray(t)&&"number"==typeof t.length){var a=t.length;return function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}(t,void 0!==n&&n<a?n:a)}return e(t,n)}var A=function(e){var t=e.title,n=e.content,u=e.ok,d=e.cancel,p=e.onOk,A=e.onCancel,b=Object(r.default)(e,h),m=Object(i.useState)(!0),C=f(a.a,m,2),E=C[0],v=C[1],I=function(e){return function(){v(!1),e()}},B=Object(g.b)();return Object(c.b)(s.b,Object.assign(Object.assign({closeButton:null,maskClosable:!1,hotKeyClosable:!1,css:[{overflow:"hidden",maxWidth:"96vw",".Modal-content":{margin:0,padding:0}},B.Mobile&&{width:320,borderRadius:12,boxShadow:""}]},b),{},{children:E&&Object(c.c)(o.Box,{px:"36px",py:"24px",children:[t&&Object(c.b)(o.Text,{fontSize:"18px",lineHeight:"28px",fontWeight:"bold",textAlign:"center",children:t}),n&&Object(c.b)(o.Text,{mt:t?"16px":"0",fontSize:"14px",lineHeight:"normal",color:"GBK03A",maxHeight:"calc(67vh - 100px)",css:{wordBreak:"break-all",overflowY:"auto",WebkitOverflowScrolling:"touch",marginRight:-10,paddingRight:10},children:n}),Object(c.c)(o.Flex,{mt:"16px",css:{button:{padding:0,flex:1,height:36,lineHeight:1,fontSize:15,borderRadius:4,":active":{opacity:.6}}},fontWeight:"bold",children:[d&&Object(c.b)(l.c,{css:{marginRight:4},onClick:I(A),children:d}),Object(c.b)(l.c,{preset:"primary",color:"blue",onClick:I(p),children:u})]})]})}))};t.a=function(){var e=Object(p.b)(),t=e.addInstance,n=e.removeInstance,a=function(e){return setTimeout((function(){return n(e)}),300)};return{alert:function(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.title,o=r.ok;return new Promise((function(a){n=Object(c.b)(A,{content:e,title:i,ok:o||"确定",onOk:a,css:{textAlign:"center"}},d()("modal")),t(n)})).finally((function(){return a(n)}))},confirm:function(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.title,o=r.ok,s=r.cancel;return new Promise((function(a,r){n=Object(c.b)(A,{content:e,title:i,ok:o||"确定",onOk:a,cancel:s||"取消",onCancel:r},d()("modal")),t(n)})).finally((function(){return a(n)}))}}}}}]);
//# sourceMappingURL=main.shared_05fdcb6c7efff2d88d20b6f2c3d1bd3ad9f2b21d.51f5070be7c825984b3d.js.map